### **链路层与局域网-1**  
---

#### **1. 链路层核心服务**  
| **服务**          | **功能**                                                                 | **示例**                     |  
|-------------------|--------------------------------------------------------------------------|-----------------------------|  
| **成帧与链路接入** | 封装数据报为帧，添加头尾标志；共享介质时控制访问（如CSMA/CD）           | Ethernet帧（前导码+MAC地址）|  
| **可靠交付**       | 相邻节点间可靠传输（常用于高误码率链路，如无线网络）                     | 802.11 Wi-Fi重传机制        |  
| **流量控制**       | 协调发送方与接收方的速率，防止接收方过载                                 | 滑动窗口协议                |  
| **差错检测**       | 通过CRC、校验和等检测比特错误                                            | Ethernet CRC-32             |  
| **差错纠正**       | 直接修复错误比特（如汉明码）                                             | 卫星通信中的前向纠错        |  

**关键问题**：  
- **为何需要链路层与端到端双重可靠性**？  
  - 链路层：快速修复局部错误（如无线链路高误码）。  
  - 传输层（如TCP）：确保端到端可靠性（如路由器崩溃导致丢包）。  

---

#### **2. 差错检测与纠正技术**  
**方法对比**：  
| **技术**         | **原理**                                  | **检测能力**               | **应用场景**       |  
|------------------|------------------------------------------|---------------------------|-------------------|  
| **奇偶校验**     | 添加奇偶位使1的个数为奇/偶                | 单比特错误                 | 内存校验          |  
| **二维奇偶校验** | 行列双重校验                              | 检测并纠正单比特错误       | 早期通信系统      |  
| **Internet校验和** | 16位反码求和                              | 弱（可能漏检多比特错误）   | IP、TCP、UDP头部  |  
| **CRC**          | 多项式除法生成冗余码（模2运算）            | 检测所有≤r比特的突发错误   | Ethernet、Wi-Fi   |  

**CRC计算示例**：  
- **数据D**：`1001`，生成多项式G：`1010`（r=3）  
- 计算步骤：  
  1. D左移r位：`1001000`  
  2. 模2除法：`1001000 ÷ 1010` → 余数`110`  
  3. 发送帧：`1001110`  

---

#### **3. 多路访问协议分类**  
**三大类协议**：  
1. **信道划分**：  
   - **TDMA**：分时槽，固定分配（如传统电话网络）。  
   - **FDMA**：分频段，固定分配（如广播电视频道）。  
   - **缺点**：低负载时效率低（时槽/频段闲置）。  

2. **随机访问**：  
   - **ALOHA**：直接发送，冲突后随机重传（效率仅18%）。  
   - **CSMA/CD**：先监听后发送，冲突检测后指数退避（Ethernet使用）。  
   - **CSMA/CA**：无线网络避免冲突（如802.11 Wi-Fi）。  

3. **轮询**：  
   - **集中式轮询**：主节点询问从节点（如蓝牙）。  
   - **令牌传递**：令牌控制发送权（如令牌环网）。  

**CSMA/CD关键流程**：  
1. 监听信道，空闲则发送。  
2. 检测冲突：若冲突，发送Jam信号并中止。  
3. 指数退避：第m次冲突后，随机选择K∈[0, 2^m-1]，等待K×512比特时间。  

---

#### **4. 局域网（LAN）与MAC地址**  
**MAC地址特性**：  
- **48位**，十六进制表示（如`1A-2F-BB-76-09-AD`）。  
- **全局唯一**：由IEEE分配厂商前缀（如`1A-2F-BB`属Intel）。  
- **平面结构**：与网络拓扑无关，可随意迁移。  

**ARP协议**：  
- **功能**：通过IP地址查询MAC地址（如`137.196.7.23 → 74-29-9C-E8-FF-55`）。  
- **流程**：  
  1. 广播ARP请求（目标MAC=`FF-FF-FF-FF-FF-FF`）。  
  2. 目标主机单播回复ARP响应。  
  3. 更新ARP缓存（TTL通常20分钟）。  

**跨子网通信示例**：  
- **主机A→路由器R→主机B**：  
  1. A封装帧：目标MAC=R的MAC（`E6-E9-00-17-BB-4B`）。  
  2. R解封装后重新封装：目标MAC=B的MAC（`49-BD-D2-C7-56-2A`）。  