### **计算机网络中的安全-2**  
---

#### **1. 传输层安全（TLS）**  
**核心功能**：  
- **机密性**：AES对称加密（如AES-256-GCM）  
- **完整性**：HMAC-SHA256消息认证码  
- **认证**：X.509数字证书（RSA/ECDSA签名）  

**TLS 1.3优化**：  
| **改进点**          | TLS 1.2（2008）               | TLS 1.3（2018）               |  
|---------------------|-----------------------------|-----------------------------|  
| **握手时延**        | 2 RTT（含密钥交换）           | 1 RTT（0-RTT可选）            |  
| **密钥交换**        | 支持RSA/DH                  | 仅限DH（前向安全性）           |  
| **加密套件**        | 37种（含不安全选项）          | 5种（AES+HMAC-SHA2）          |  

**握手流程**：  
1. **ClientHello**：发送支持的加密套件+DH参数。  
2. **ServerHello**：选定加密套件+服务器DH参数+证书。  
3. **密钥派生**：双方通过DH生成主密钥→派生会话密钥（`K_c`/`M_c`等）。  

**记录协议**：  
- 数据分块为**记录**（含类型、序列号、MAC），防止重放/篡改。  
- **关闭安全**：专用记录类型（type=1）避免截断攻击。  

---

#### **2. 网络层安全（IPsec）**  
**两种模式**：  
| **模式**       | 传输模式                     | 隧道模式                     |  
|----------------|----------------------------|----------------------------|  
| **加密范围**   | 仅载荷（上层数据）           | 整个原始IP包+新IP头          |  
| **典型应用**   | 端到端安全（如主机间）       | VPN网关间通信               |  

**协议组件**：  
- **ESP**（封装安全载荷）：提供加密+认证（如AES-CBC+HMAC）。  
- **AH**（认证头）：仅认证（无加密，已少用）。  

**安全关联（SA）**：  
- **SPD**（策略库）：定义哪些流量需IPsec处理（如基于源/目的IP）。  
- **SAD**（关联库）：存储加密密钥、SPI等参数。  

**抗重放攻击**：  
- 序列号+滑动窗口机制（默认窗口大小32）。  

---

#### **3. 无线网络安全（WiFi/4G/5G）**  
**802.11 WPA3认证流程**：  
1. **发现阶段**：AP广播安全能力（如WPA3-Enterprise）。  
2. **双向认证**：  
   - 基于共享密钥（PSK）或EAP-TLS证书。  
   - 生成会话密钥`K_M-AP`（如通过DH交换）。  
3. **加密通信**：AES-CCMP加密数据帧。  

**4G LTE认证特点**：  
- **SIM卡**：存储IMSI和预共享密钥`K_HSS-M`。  
- **分层认证**：  
  1. 终端→MME→HSS（家乡网络）验证。  
  2. HSS生成`xres`，终端返回`res`匹配后认证通过。  
- **密钥派生**：`K_BS-M`用于空口加密。  

**5G增强**：  
- **SUPI保护**：公钥加密用户标识（防IMSI嗅探）。  
- **服务化架构**：认证决策由家乡网络统一控制。  

---

#### **4. 防火墙与入侵检测**  
**防火墙类型**：  
| **类型**         | 工作层次          | 优缺点                      |  
|------------------|-----------------|---------------------------|  
| **无状态包过滤** | 网络层           | 快但无法识别会话（如允许ACK包穿透） |  
| **有状态包过滤** | 传输层           | 跟踪TCP状态（阻止非法SYN/ACK）   |  
| **应用网关**     | 应用层           | 深度检测（如HTTP头过滤）但延迟高  |  

**ACL示例**：  
```plaintext
动作   源IP        目的IP      协议 源端口 目的端口 标志位  
allow  222.22/16  any         TCP  >1023  80       ANY  
allow  any        222.22/16   TCP  80     >1023    ACK  
deny   all        all         all  all    all      all  
```

**入侵检测系统（IDS）**：  
- **检测技术**：  
  - **特征匹配**：对比流量与攻击特征库（如SQL注入字符串）。  
  - **异常检测**：机器学习识别偏离基线行为（如突发DDoS）。  
- **部署位置**：DMZ区（监控内外网流量）、核心网络（内部威胁）。  

---

### **关键问题解析**  
1. **问题**：TLS 1.3为何移除RSA密钥交换？  
   **答**：RSA不具备前向安全性，若私钥泄露，历史通信可被解密；DH每次会话生成临时密钥更安全。  

2. **问题**：IPsec隧道模式为何适合VPN？  
   **答**：加密原始IP头可隐藏内网拓扑，且支持NAT穿越（ESP封装后外层IP可路由）。  

3. **问题**：5G如何改进4G的认证缺陷？  
   **答**：4G的IMSI明文传输易被嗅探，5G使用公钥加密SUPI（用户永久标识符）。  
