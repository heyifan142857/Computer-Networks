### **计算机网络中的安全-1**  
---

#### **1. 网络安全核心目标**  
| **目标**               | **定义**                                                                 | **技术实现**                  |  
|------------------------|-------------------------------------------------------------------------|-----------------------------|  
| **机密性**             | 仅发送方和接收方能理解消息内容                                             | 加密（对称/非对称密钥）         |  
| **认证**               | 确认通信双方身份的真实性                                                   | 数字证书、挑战-响应协议          |  
| **消息完整性**         | 确保消息在传输中未被篡改                                                   | 哈希函数+数字签名（如SHA-256）  |  
| **可用性**             | 服务可被合法用户正常访问                                                   | DDoS防御、冗余设计             |  

---

#### **2. 密码学基础**  
**对称加密 vs 非对称加密**：  
| **特性**         | 对称加密（AES/DES）               | 非对称加密（RSA/ECC）              |  
|------------------|----------------------------------|----------------------------------|  
| **密钥**         | 共享同一密钥                       | 公钥加密，私钥解密                  |  
| **速度**         | 快（适合大数据量）                 | 慢（适合密钥交换/签名）              |  
| **应用场景**     | 数据加密（如TLS会话密钥）           | 密钥交换、数字签名                  |  

**RSA算法步骤**：  
1. **密钥生成**：  
   - 选大素数`p,q`，计算`n=p*q`，`z=(p-1)*(q-1)`。  
   - 选`e`与`z`互质，计算`d`满足`(e*d) mod z = 1`。  
   - 公钥：`(n,e)`，私钥：`(n,d)`。  
2. **加密/解密**：  
   - 加密：`c = m^e mod n`  
   - 解密：`m = c^d mod n`  

**示例**：  
- `p=5`, `q=7` → `n=35`, `z=24`  
- 选`e=5`（与24互质），`d=29`（因`5*29=145=6*24+1`）  
- 加密`m=12`：`12^5 mod 35 = 17`  
- 解密`c=17`：`17^29 mod 35 = 12`  

---

#### **3. 认证协议与攻击**  
**认证协议演进**：  
- **ap1.0**：明文声明身份 → **攻击**：冒充（Trudy自称Alice）。  
- **ap3.0**：密码认证 → **攻击**：重放攻击（Trudy记录密码后重放）。  
- **ap4.0**：挑战-响应（Nonce + 对称加密） → **缺陷**：需预共享密钥。  
- **ap5.0**：非对称加密（Nonce + 私钥签名） → **攻击**：中间人攻击（需CA解决）。  

**中间人攻击场景**：  
1. Trudy拦截Bob请求，冒充Alice向Bob发送自己的公钥`K_T+`。  
2. Trudy拦截Alice响应，冒充Bob向Alice发送自己的公钥`K_T+`。  
3. 双方通信均被Trudy解密/篡改。  

**解决方案**：数字证书（CA签发公钥绑定身份）。  

---

#### **4. 数字签名与消息完整性**  
**流程**：  
1. **发送方**：  
   - 计算消息哈希`H(m)`。  
   - 用私钥加密哈希：`K_B-(H(m))`。  
   - 发送`(m, K_B-(H(m))`。  
2. **接收方**：  
   - 用发送方公钥解密签名：`H(m)' = K_B+(K_B-(H(m)))`。  
   - 计算消息哈希`H(m)`，对比`H(m)'`验证完整性。  

**哈希函数要求**：  
- **抗碰撞性**：难以找到`m' ≠ m`但`H(m') = H(m)`。  
- **单向性**：无法从`H(m)`反推`m`。  
- **常用算法**：SHA-256（取代MD5/SHA-1）。  

---

#### **5. 安全电子邮件实现**  
**机密性 + 完整性 + 认证**：  
1. **Alice生成随机对称密钥`K_S`**，加密消息：`K_S(m)`。  
2. **用Bob公钥加密`K_S`**：`K_B+(K_S)`。  
3. **签名哈希**：`K_A-(H(m))`。  
4. **发送**：`[K_S(m), K_B+(K_S), K_A-(H(m))]`。  
5. **Bob解密**：  
   - 用私钥获取`K_S` → 解密`m`。  
   - 用Alice公钥验证签名 → 确认身份和完整性。  

---

### **高频面试题**  
1. **问题**：为什么RSA加密不直接用于大数据？  
   **答**：非对称加密计算开销大，通常仅用于交换对称密钥（如TLS）。  

2. **问题**：如何防御中间人攻击？  
   **答**：使用CA签发的数字证书验证公钥归属（如HTTPS证书）。  

3. **问题**：SHA-256比MD5更安全的原因？  
   **答**：更长摘要（256bit）、更强抗碰撞性（MD5已破解）。  

4. **问题**：数字签名如何实现不可否认性？  
   **答**：签名需私钥生成，仅发送方持有，可提交法庭作为证据。  

